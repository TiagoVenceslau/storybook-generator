import { createStoryboard } from "../../src/mastra";

const input = {
  "script": "{\n  \"title\": \"Even a mistake can make a friend.\",\n  \"genre\": \"Children's\",\n  \"logline\": \"In a sunlit forest, a little blue-eyed boy who can talk to animals and his blue-spotted raven discover that a mixed-up carrot and a startled mole can turn a funny mistake into a brand-new friendship.\",\n  \"characters\": [\n    {\n      \"name\": \"Harry\",\n      \"description\": \"A little blue-eyed boy in a shirt and overalls who, for a magic reason, understands and speaks with animals; curious, gentle, and brave in small ways.\",\n      \"role\": \"Protagonist\"\n    },\n    {\n      \"name\": \"Luna\",\n      \"description\": \"An unusually large, blue-spotted raven who often rides on Harry’s shoulder; witty, watchful, and fond of shiny jokes.\",\n      \"role\": \"Supporting\"\n    },\n    {\n      \"name\": \"Pippa\",\n      \"description\": \"A lively pink rabbit with boundless energy, determined to find the biggest carrot for supper.\",\n      \"role\": \"Supporting\"\n    },\n    {\n      \"name\": \"Morris\",\n      \"description\": \"A mole with velvety brown fur and a sensitive tail; proud of his carefully dug tunnels and quick to startle, but soft-hearted underneath.\",\n      \"role\": \"Antagonist\"\n    }\n  ],\n  \"scenes\": [\n    {\n      \"sceneNumber\": 1,\n      \"location\": \"Lush forest path, dappled with sunlight\",\n      \"timeOfDay\": \"Morning\",\n      \"description\": \"Birdsong fills the air as Harry strolls along a mossy path. Luna perches on his shoulder, preening a blue-spotted wing. Leaves shimmer and small critters peek out from ferns. Harry hums, tapping his overalls pocket in rhythm.\",\n      \"dialogue\": \"Harry: Good morning, forest. Everyone get breakfast yet?\\nSquirrel (chittering from a branch): Nuts are extra crunchy today!\\nHarry: Crunchy is the best kind of nut.\\nLuna: And I prefer breakfast with a side of sparkle. Any shiny beetles about?\\nBeetle (from a log): Shiny, yes! Peck me not, please.\\nHarry (giggling): She’s teasing, Mr. Beetle. We’re just passing through.\\nLuna (softly to Harry): Keep those ears open, Blue Eyes. The woods are full of secrets today.\"\n    },\n    {\n      \"sceneNumber\": 2,\n      \"location\": \"Sunny glade with tall grasses and wildflowers\",\n      \"timeOfDay\": \"Late Morning\",\n      \"description\": \"In a small clearing, a bright-pink rabbit braces her feet and tugs at an orange tip sticking from the soil. The grasses sway as she grunts and pulls to no avail.\",\n      \"dialogue\": \"Pippa: One... two... three—heave! Oh, carrot, come on!\\nHarry (approaching kindly): Need a tug-buddy?\\nPippa (startled, then hopeful): Hi! I’m Pippa. I promised my family the biggest carrot in the whole glade.\\nLuna (tilting her head): It’s either a very stubborn carrot or it’s been doing tail-lifts.\\nPippa (giggles): Help me count? On three!\\nHarry: Ready. One... two... three!\"\n    },\n    {\n      \"sceneNumber\": 3,\n      \"location\": \"Edge of a burrow near the glade\",\n      \"timeOfDay\": \"Midday\",\n      \"description\": \"Harry and Pippa tug. The orange tip jerks, then a surprised yelp bubbles up from underground. A mole pops out—wide-eyed—revealing the “carrot” is his tail, dusty and offended.\",\n      \"dialogue\": \"Morris: Yipe! Mind my tail! That’s no vegetable—it’s attached to me!\\nPippa (hopping back, horrified): Oh no, oh no! I’m so sorry! I thought—\\nHarry (hands raised gently): We didn’t mean to hurt you, Mr. Mole. I can understand you. Are you okay?\\nMorris (rubbing his tail): A bit ruffled, lad. My tunnels are delicate! Imagine someone yanking your hat.\\nLuna (soothing): His hat is his tail today. Deep breaths, everyone.\\nPippa (ears drooping): I only wanted a carrot for supper. I wasn’t looking closely.\\nHarry: Let’s fix this. Maybe we can help mend any tunnel mishaps and find a real carrot nearby.\"\n    },\n    {\n      \"sceneNumber\": 4,\n      \"location\": \"Field edge with a real carrot patch\",\n      \"timeOfDay\": \"Afternoon\",\n      \"description\": \"Morris guides them with soft thumps along his tunnel. The ground hums underfoot. They arrive at a patch where ferny tops feather from the soil. Sunlight paints everything gold-green.\",\n      \"dialogue\": \"Morris (sniffing): Hm. Carrot-scent to the east. Real ones.\\nHarry (kneeling): We’ll pull carefully, straight up.\\nPippa (determined, smiling): I’ll do it gently this time.\\nLuna: I’ll supervise from above—chief of crow-safety and carrot-cheer.\\nPippa (steady pull): One… two… three… got it!\\nMorris (grinning): Splendid root—no tails attached.\\nHarry: Thank you, Morris. Your tunnels led us right here.\\nMorris (bashful): Well, I do know my underground. Apology accepted, Miss Pippa. No hard feelings.\\nPippa (relieved): Friends?\\nMorris: Friends.\"\n    },\n    {\n      \"sceneNumber\": 5,\n      \"location\": \"Woodland clearing under a warm sunset\",\n      \"timeOfDay\": \"Sunset\",\n      \"description\": \"They share crunchy carrot slices atop a mossy log. Luna balances a carrot coin on her beak; Harry laughs. Fireflies blink on as the sky turns peach and lavender.\",\n      \"dialogue\": \"Luna (muffled by carrot coin): Behold! The Great Balancing Beak!\\nHarry (clapping): Bravo, Luna!\\nPippa (nibbling happily): Best supper ever—and best surprise, too.\\nMorris (content): A tidy tail, a fixed tunnel, and new friends. Not a bad day for a mole.\\nHarry (smiling at them all): Even a mistake can make a friend, if we listen and make it right.\\nLuna (warmly): To new friends—and properly identified vegetables!\\nAll (laughing): To friends!\"\n    }\n  ]\n}",
  "title": "Even a mistake can make a friend",
  "genre": "child",
  "tone": "playful, cheerful",
  "style": "Coloring Book"
}

jest.setTimeout(300000)

describe("generate storyboard", () => {
  it("should generate a storyboard", async () => {
  const result = await createStoryboard(input.script, {
      style: input.style,
      numberOfImages: 5,
      quality: "standard"
    })

    expect(result).toBeDefined();
  })
})